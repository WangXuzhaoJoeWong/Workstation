# 快速开始（编译/运行）

## 1) 编译

Workstation 是独立工程，推荐依赖已安装的 MotionCore（`find_package(MotionCore CONFIG REQUIRED)`）。

先构建并安装 MotionCore（示例安装到工作空间内）：

```bash
WS=$(pwd)

cd MotionCore
mkdir -p build
cd build

cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX="$WS/MotionCore/_install"
make -j"$(nproc)"
make install
```

再独立构建 Workstation：

```bash
WS=$(pwd)
cd Workstation
mkdir -p build
cd build

cmake .. \
  -DCMAKE_BUILD_TYPE=Release \
  -DCMAKE_PREFIX_PATH="$WS/MotionCore/_install" \
  -DWXZ_WORKSTATION_ENABLE_BT=ON \
  -DWXZ_WORKSTATION_BT_FETCHCONTENT=ON
make -j"$(nproc)"
```

说明：
- 如果不想 FetchContent 拉取 BT 依赖，可改用 `-DWXZ_WORKSTATION_BT_ROOT=/path/to/BehaviorTree.CPP`。
- 生成的可执行文件：
  - `Workstation/build/workstation_arm_control_service`
  - `Workstation/build/workstation_bt_service`

## 2) 运行（本机前台）

最简单方式：两个独立终端分别启动两个服务。

终端 A（arm_control）：

```bash
WS=$(pwd)
BUILD_DIR=$WS/Workstation/build
MOTIONCORE_PREFIX=$WS/MotionCore/_install

set -a
source $WS/Workstation/resources/workstation.env.sample
# 或者：source /etc/workstation/workstation.env
set +a

# arm SDK 动态库路径（按需调整）
export LD_LIBRARY_PATH="$WS/Workstation/depends/CGXi_Robot_SDK/libs:${MOTIONCORE_PREFIX}/lib:${LD_LIBRARY_PATH:-}"

$BUILD_DIR/workstation_arm_control_service
```

终端 B（bt_service）：

```bash
WS=$(pwd)
BUILD_DIR=$WS/Workstation/build
MOTIONCORE_PREFIX=$WS/MotionCore/_install

set -a
source $WS/Workstation/resources/workstation.env.sample
set +a

export LD_LIBRARY_PATH="${MOTIONCORE_PREFIX}/lib:${LD_LIBRARY_PATH:-}"

$BUILD_DIR/workstation_bt_service
```

## 3) 最小验证

1) 确认两个进程都在跑：
- `arm_control` 输出里应看到 `start ip=... domain=... cmd='...' status='...'`
- `bt_service` 输出里应看到 `start domain=... xml='...' tick_ms=... reload_ms=...`

2) 编辑 BT XML（默认：`Workstation/resources/bt.xml.sample`），保存后应看到 bt_service 触发热加载日志（`tree loaded`）。

